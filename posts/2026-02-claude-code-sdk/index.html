<!doctype html><html lang=en-us><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><title>Claude Code SDK is pretty wild | Brandon Davis</title><meta property="og:url" content="https://subdavis.com/posts/2026-02-claude-code-sdk/"><meta property="og:site_name" content="Brandon Davis"><meta property="og:title" content="Claude Code SDK is pretty wild"><meta property="og:description" content="Mixing claude with procedural code beyond one-shot i/o."><meta property="og:locale" content="en_us"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2026-02-11T22:00:00+00:00"><meta property="article:modified_time" content="2026-02-11T22:00:00+00:00"><meta property="og:image" content="https://subdavis.com/posts/2026-02-claude-code-sdk/topreventwar.jpg"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://subdavis.com/posts/2026-02-claude-code-sdk/topreventwar.jpg"><meta name=twitter:title content="Claude Code SDK is pretty wild"><meta name=twitter:description content="Mixing claude with procedural code beyond one-shot i/o."><link rel=icon type=image/x-icon href=/favicon.ico><link rel=webmention href=https://webmention.io/subdavis.com/webmention><link rel=preload href=/font/IM_Fell_Great_Primer/IMFellGreatPrimer-Regular.ttf as=font type=font/ttf crossorigin=anonymous>
    
  
  
    
      
        <link rel="stylesheet" href="/css/main.cbe5ecf8e254369109cde5d958c9c38236ea1dab23aebf7d21af7822e270af12.css" integrity="sha256-y&#43;Xs&#43;OJUNpEJzeXZWMnDgjbqHasjrr99Ia94IuJwrxI=" crossorigin="anonymous">
      
    
  

  
<script defer data-website-id=bfadb547-f5e5-4a8e-9416-13340a2bfdfd src=https://umami.subdavis.com/script.js data-domains=subdavis.com></script></head><body class=bg-white><div class="max-w-screen-sm mx-auto px-4"><main class="main w-full bg-white"><div class="my-6 max-w-screen-sm"><nav aria-label=Breadcrumb class=mb-6><ol class="flex flex-wrap items-center space-x-2 text-sm text-accent-3"><li class="flex items-center space-x-2 text-nowrap"><a href=/ class="text-accent-4 hover:text-accent-4 transition-colors">Brandon Davis
</a><span class=text-accent-3>/</span></li><li class="flex items-center space-x-2 text-nowrap"><a href=/posts/ class="text-accent-4 hover:text-accent-4 transition-colors">Posts
</a><span class=text-accent-3>/</span></li><li class="flex items-center space-x-2"><span class=text-accent-4>Claude Code SDK is pretty wild</span></li></ol></nav><article class=max-w-none><header class=mb-8><h1 class="text-4xl font-bold text-accent-4 mb-2">Claude Code SDK is pretty wild</h1><time class="text-accent-3 text-sm mb-4 date-style" datetime='February 11, 2026'>February 11, 2026</time><p class="text-xl text-accent-4 italic">Mixing claude with procedural code beyond one-shot i/o.</p></header><div class="prose text-accent-4 leading-6"><p><img src=./claude.webp alt="Claude Code"></p><p>I&rsquo;ve been using claude code on and off since it launched a year ago. Since the Christmas holiday, it seems <a href=https://www.theargumentmag.com/p/i-cant-stop-yelling-at-claude-code>a ton of folks outside the software industry have discovered it</a> as well.</p><p>Despite its popularity, I&rsquo;ve seen almost no discussion of Claude Code SDK. It&rsquo;s essentially a typescript or <a href=https://platform.claude.com/docs/en/agent-sdk/python>python</a> wrapper to the agent harness that allows you to fully manage the handoff between agentic and procedural parts of an application.</p><h2 id=beyond---print-mode>Beyond <code>--print</code> mode</h2><p>If you&rsquo;ve discovered the <code>--print</code> flag, you&rsquo;ve almost certainly scripted up some terrible nonsense to run it as a subprocess.</p><p><strong>Stop that right now!</strong></p><p>The <a href=https://platform.claude.com/docs/en/api/sdks/python>SDK documentation is dense</a>. It does not take the time to explain the basics of the turn loop or tool hooks. I suspect that most people who <em>have</em> attempted to use the SDK have done so in a one-shot sort of way, by giving a prompt and letting Claude cook until it yields.</p><h2 id=control-handoff-and-tool-use>Control handoff and tool use</h2><p>Claude code is just a while loop.</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-txt data-lang=txt><span style=display:flex><span>until llm says stop:
</span></span><span style=display:flex><span>   give llm some inputs
</span></span><span style=display:flex><span>   do whatever it says (read file, run bash)
</span></span></code></pre></div><p>When you build an <a href=https://platform.claude.com/docs/en/agents-and-tools/agent-skills/overview>agent <code>SKILL.md</code></a>, you hand-wavishly describe how to use an API or function or script. Claude reads those instructions and then uses its existing tools (read/write/bash/grep) to do whatever the skill describes.</p><blockquote><p>Claude is like the little dude inside the big dude&rsquo;s head</p><p>&ndash; Will Smith</p></blockquote><p><img src=./topreventwar.jpg alt="To Prevent War"></p><p>When you build custom tools with the SDK, you must <a href=https://platform.claude.com/docs/en/agent-sdk/custom-tools>implement an MCP tool interface</a>, run it synchronously in-process, and hand the output back for the next turn.</p><h2 id=a-toy-example>A Toy Example</h2><p>The official docs provide <a href=https://platform.claude.com/docs/en/api/sdks/python#tool-helpers>this example</a>. It&rsquo;s a bit unsatisfying because it hides the details, so let&rsquo;s reimplement without the automagical <code>tool_runner</code>.</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#cf222e>from</span> <span style=color:#24292e>anthropic</span> <span style=color:#cf222e>import</span> Anthropic
</span></span><span style=display:flex><span><span style=color:#cf222e>import</span> <span style=color:#24292e>json</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>client <span style=color:#0550ae>=</span> Anthropic<span style=color:#1f2328>()</span>
</span></span><span style=display:flex><span>max_turns <span style=color:#0550ae>=</span> <span style=color:#0550ae>10</span>
</span></span><span style=display:flex><span>SYSTEM_PROMPT <span style=color:#0550ae>=</span> <span style=color:#0a3069>&#34;System Prompt Here&#34;</span>
</span></span><span style=display:flex><span>MESSAGES <span style=color:#0550ae>=</span> <span style=color:#1f2328>[{</span><span style=color:#0a3069>&#34;role&#34;</span><span style=color:#1f2328>:</span> <span style=color:#0a3069>&#34;user&#34;</span><span style=color:#1f2328>,</span> <span style=color:#0a3069>&#34;content&#34;</span><span style=color:#1f2328>:</span> <span style=color:#1f2328>[{</span><span style=color:#0a3069>&#34;type&#34;</span><span style=color:#1f2328>:</span> <span style=color:#0a3069>&#34;text&#34;</span><span style=color:#1f2328>,</span> <span style=color:#0a3069>&#34;text&#34;</span><span style=color:#1f2328>:</span> <span style=color:#0a3069>&#34;Tell me the weather in San Francisco.&#34;</span> <span style=color:#1f2328>}]}]</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#57606a># This is the MCP spec!</span>
</span></span><span style=display:flex><span>TOOLS <span style=color:#0550ae>=</span> <span style=color:#1f2328>[{</span>
</span></span><span style=display:flex><span>    <span style=color:#0a3069>&#34;name&#34;</span><span style=color:#1f2328>:</span> <span style=color:#0a3069>&#34;get_weather&#34;</span><span style=color:#1f2328>,</span>
</span></span><span style=display:flex><span>    <span style=color:#0a3069>&#34;description&#34;</span><span style=color:#1f2328>:</span> <span style=color:#0a3069>&#34;Get the current weather in a given location&#34;</span><span style=color:#1f2328>,</span>
</span></span><span style=display:flex><span>    <span style=color:#0a3069>&#34;input_schema&#34;</span><span style=color:#1f2328>:</span> <span style=color:#1f2328>{</span>
</span></span><span style=display:flex><span>        <span style=color:#0a3069>&#34;type&#34;</span><span style=color:#1f2328>:</span> <span style=color:#0a3069>&#34;object&#34;</span><span style=color:#1f2328>,</span>
</span></span><span style=display:flex><span>        <span style=color:#0a3069>&#34;properties&#34;</span><span style=color:#1f2328>:</span> <span style=color:#1f2328>{</span>
</span></span><span style=display:flex><span>            <span style=color:#0a3069>&#34;location&#34;</span><span style=color:#1f2328>:</span> <span style=color:#1f2328>{</span>
</span></span><span style=display:flex><span>                <span style=color:#0a3069>&#34;type&#34;</span><span style=color:#1f2328>:</span> <span style=color:#0a3069>&#34;string&#34;</span><span style=color:#1f2328>,</span>
</span></span><span style=display:flex><span>                <span style=color:#0a3069>&#34;description&#34;</span><span style=color:#1f2328>:</span> <span style=color:#0a3069>&#34;The city and state, e.g. San Francisco, CA&#34;</span>
</span></span><span style=display:flex><span>            <span style=color:#1f2328>}</span>
</span></span><span style=display:flex><span>        <span style=color:#1f2328>},</span>
</span></span><span style=display:flex><span>        <span style=color:#0a3069>&#34;required&#34;</span><span style=color:#1f2328>:</span> <span style=color:#1f2328>[</span><span style=color:#0a3069>&#34;location&#34;</span><span style=color:#1f2328>]</span>
</span></span><span style=display:flex><span>    <span style=color:#1f2328>}</span>
</span></span><span style=display:flex><span><span style=color:#1f2328>}]</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#cf222e>def</span> <span style=color:#6639ba>get_weather</span><span style=color:#1f2328>(</span>location<span style=color:#1f2328>:</span> <span style=color:#6639ba>str</span><span style=color:#1f2328>)</span> <span style=color:#0550ae>-&gt;</span> <span style=color:#6639ba>str</span><span style=color:#1f2328>:</span>
</span></span><span style=display:flex><span>    <span style=color:#cf222e>return</span> json<span style=color:#0550ae>.</span>dumps<span style=color:#1f2328>(</span>
</span></span><span style=display:flex><span>        <span style=color:#1f2328>{</span>
</span></span><span style=display:flex><span>            <span style=color:#0a3069>&#34;location&#34;</span><span style=color:#1f2328>:</span> location<span style=color:#1f2328>,</span>
</span></span><span style=display:flex><span>            <span style=color:#0a3069>&#34;temperature&#34;</span><span style=color:#1f2328>:</span> <span style=color:#0a3069>&#34;68°F&#34;</span><span style=color:#1f2328>,</span>
</span></span><span style=display:flex><span>            <span style=color:#0a3069>&#34;condition&#34;</span><span style=color:#1f2328>:</span> <span style=color:#0a3069>&#34;Sunny&#34;</span><span style=color:#1f2328>,</span>
</span></span><span style=display:flex><span>        <span style=color:#1f2328>}</span>
</span></span><span style=display:flex><span>    <span style=color:#1f2328>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#cf222e>for</span> _ <span style=color:#0550ae>in</span> <span style=color:#6639ba>range</span><span style=color:#1f2328>(</span>max_turns<span style=color:#1f2328>):</span>
</span></span><span style=display:flex><span>    response <span style=color:#0550ae>=</span> client<span style=color:#0550ae>.</span>messages<span style=color:#0550ae>.</span>create<span style=color:#1f2328>(</span>
</span></span><span style=display:flex><span>        model<span style=color:#0550ae>=</span><span style=color:#0a3069>&#34;claude-sonnet-4-5&#34;</span><span style=color:#1f2328>,</span>
</span></span><span style=display:flex><span>        max_tokens<span style=color:#0550ae>=</span><span style=color:#0550ae>4096</span><span style=color:#1f2328>,</span>
</span></span><span style=display:flex><span>        system<span style=color:#0550ae>=</span>SYSTEM_PROMPT<span style=color:#1f2328>,</span>
</span></span><span style=display:flex><span>        tools<span style=color:#0550ae>=</span>TOOLS<span style=color:#1f2328>,</span>
</span></span><span style=display:flex><span>        messages<span style=color:#0550ae>=</span>MESSAGES<span style=color:#1f2328>,</span>
</span></span><span style=display:flex><span>    <span style=color:#1f2328>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#cf222e>if</span> response<span style=color:#0550ae>.</span>stop_reason <span style=color:#0550ae>==</span> <span style=color:#0a3069>&#34;tool_use&#34;</span><span style=color:#1f2328>:</span>
</span></span><span style=display:flex><span>        tool_results <span style=color:#0550ae>=</span> <span style=color:#1f2328>[]</span>
</span></span><span style=display:flex><span>        assistant_content <span style=color:#0550ae>=</span> <span style=color:#1f2328>[]</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#cf222e>for</span> block <span style=color:#0550ae>in</span> response<span style=color:#0550ae>.</span>content<span style=color:#1f2328>:</span>
</span></span><span style=display:flex><span>            assistant_content<span style=color:#0550ae>.</span>append<span style=color:#1f2328>(</span>block<span style=color:#1f2328>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            <span style=color:#57606a># Do what claude says</span>
</span></span><span style=display:flex><span>            <span style=color:#cf222e>if</span> block<span style=color:#0550ae>.</span>type <span style=color:#0550ae>==</span> <span style=color:#0a3069>&#34;tool_use&#34;</span><span style=color:#1f2328>:</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                <span style=color:#cf222e>if</span> block<span style=color:#0550ae>.</span>name <span style=color:#0550ae>==</span> <span style=color:#0a3069>&#34;get_weather&#34;</span><span style=color:#1f2328>:</span>
</span></span><span style=display:flex><span>                    result <span style=color:#0550ae>=</span> get_weather<span style=color:#1f2328>(</span>block<span style=color:#0550ae>.</span>input<span style=color:#0550ae>.</span>get<span style=color:#1f2328>(</span><span style=color:#0a3069>&#34;location&#34;</span><span style=color:#1f2328>))</span>
</span></span><span style=display:flex><span>                    tool_results<span style=color:#0550ae>.</span>append<span style=color:#1f2328>({</span>
</span></span><span style=display:flex><span>                        <span style=color:#0a3069>&#34;type&#34;</span><span style=color:#1f2328>:</span> <span style=color:#0a3069>&#34;tool_result&#34;</span><span style=color:#1f2328>,</span>
</span></span><span style=display:flex><span>                        <span style=color:#0a3069>&#34;tool_use_id&#34;</span><span style=color:#1f2328>:</span> block<span style=color:#0550ae>.</span>id<span style=color:#1f2328>,</span>
</span></span><span style=display:flex><span>                        <span style=color:#0a3069>&#34;content&#34;</span><span style=color:#1f2328>:</span> json<span style=color:#0550ae>.</span>dumps<span style=color:#1f2328>(</span>result<span style=color:#1f2328>),</span>
</span></span><span style=display:flex><span>                    <span style=color:#1f2328>})</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#57606a># Append the request and response to the session log:</span>
</span></span><span style=display:flex><span>        <span style=color:#57606a># Claude says &#34;Please run this tool&#34;</span>
</span></span><span style=display:flex><span>        messages<span style=color:#0550ae>.</span>append<span style=color:#1f2328>({</span><span style=color:#0a3069>&#34;role&#34;</span><span style=color:#1f2328>:</span> <span style=color:#0a3069>&#34;assistant&#34;</span><span style=color:#1f2328>,</span> <span style=color:#0a3069>&#34;content&#34;</span><span style=color:#1f2328>:</span> assistant_content<span style=color:#1f2328>})</span>
</span></span><span style=display:flex><span>        <span style=color:#57606a># User says &#34;Here you go&#34;</span>
</span></span><span style=display:flex><span>        messages<span style=color:#0550ae>.</span>append<span style=color:#1f2328>({</span><span style=color:#0a3069>&#34;role&#34;</span><span style=color:#1f2328>:</span> <span style=color:#0a3069>&#34;user&#34;</span><span style=color:#1f2328>,</span> <span style=color:#0a3069>&#34;content&#34;</span><span style=color:#1f2328>:</span> tool_results<span style=color:#1f2328>})</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#cf222e>elif</span> response<span style=color:#0550ae>.</span>stop_reason <span style=color:#0550ae>==</span> <span style=color:#0a3069>&#34;end_turn&#34;</span><span style=color:#1f2328>:</span>
</span></span><span style=display:flex><span>        <span style=color:#6639ba>print</span><span style=color:#1f2328>(</span><span style=color:#0a3069>&#34;Claude exited.&#34;</span><span style=color:#1f2328>)</span>
</span></span></code></pre></div><p>You&rsquo;d miss it in the <code>beta.tool_runner</code> wrapper, but tool use blocks append to an ever-growing <code>messages</code> array that gets fed back into the client every turn.</p><p><strong>Thats exactly how claude code works</strong>, and its why the SDK token use grows exponentially by turn.</p><h2 id=a-working-project>A working project</h2><p>If you don&rsquo;t mind the mess, <a href=https://github.com/subdavis/bikegroups-org-calendar/blob/main/calendar_sync/claude.py>here&rsquo;s a real project for updating a Google Calendar based on the posts from an RSS stream.</a></p><p>When a post announces an upcoming event, the agent has 4 tools:</p><ul><li><code>get_images</code></li><li><code>search_events_by_date</code></li><li><code>search_events_by_keyword</code></li><li><code>submit_decision</code></li></ul><h2 id=takeaway>Takeaway</h2><p>Using the same harness framework and a completely different set of tools, claude code can do tasks entirely unrelated to writing code.</p></div><footer class="mt-8 pt-8 border-t border-accent-2 flex justify-between items-center"><a href=/posts class="link text-accent-4 hover:text-accent-4">← All posts
</a><a href=/index.xml title="Subscribe to RSS feed" class="inline-flex items-center gap-2" aria-label="RSS Feed"><svg class="inline w-5 h-5" fill="currentColor" viewBox="0 0 20 20"><path d="M5 3a1 1 0 000 2c5.523.0 10 4.477 10 10a1 1 0 102 0C17 8.373 11.627 3 5 3z"/><path d="M4 9a1 1 0 011-1 7 7 0 017 7 1 1 0 11-2 0 5 5 0 00-5-5A1 1 0 014 9zM3 15a2 2 0 114 0 2 2 0 01-4 0z"/></svg>
<span class=link>Subscribe with RSS</span></a></footer></article></div></main></div></body></html>